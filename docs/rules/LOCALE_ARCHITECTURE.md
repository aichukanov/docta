# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –ù–ï –¢–†–û–ì–ê–¢–¨

–°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç. **–ù–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ `i18n.config.ts` –≤ `nuxt.config.ts`** - —ç—Ç–æ —Å–ª–æ–º–∞–µ—Ç —Ä–∞–±–æ—Ç—É.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### 1. Server-side (SSR)

**–§–∞–π–ª:** `server/common/redirect/regional-settings.ts`

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º HTTP –∑–∞–ø—Ä–æ—Å–µ:

```typescript
function getLocaleForQuery(event): {
	locale: Locale;
	redirectStatus: 301 | 302 | null;
};
```

**–õ–æ–≥–∏–∫–∞:**

- –ß–∏—Ç–∞–µ—Ç cookie `locale` (–ù–ï `i18n_redirected`)
- –ß–∏—Ç–∞–µ—Ç query –ø–∞—Ä–∞–º–µ—Ç—Ä `?lang=XX`
- –î–µ–ª–∞–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
  - 301: –µ—Å–ª–∏ `?lang=sr` (–¥–µ—Ñ–æ–ª—Ç–Ω–∞—è –ª–æ–∫–∞–ª—å) –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ª–æ–∫–∞–ª–∏ (ME, BA)
  - 302: –µ—Å–ª–∏ cookie –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**

1. Cookie `locale`
2. Query –ø–∞—Ä–∞–º–µ—Ç—Ä `?lang=XX`
3. –î–µ—Ñ–æ–ª—Ç: `sr`

### 2. Client-side (Vue/i18n)

**–§–∞–π–ª:** `app.vue`

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å –¥–ª—è Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```typescript
const queryLocale = getLocaleFromQuery(route.query.lang as string | string[]);
locale.value = queryLocale || defaultLocale;
```

**–õ–æ–∫–∞–ª—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —è–≤–Ω–æ –≤ app.vue**, –Ω–µ —á–µ—Ä–µ–∑ –ø–ª–∞–≥–∏–Ω—ã –∏–ª–∏ middleware.

### 3. i18n –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–§–∞–π–ª:** `i18n/i18n.config.ts`

```typescript
export default defineI18nConfig(() => ({
	locales,
	defaultLocale,
	fallbackLocale: 'sr',
	locale: defaultLocale,
	legacy: false,
	// ...
}));
```

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:**

- Cookie `i18n_redirected` —Å–æ–∑–¥–∞—ë—Ç—Å—è –º–æ–¥—É–ª–µ–º `@nuxtjs/i18n`, –Ω–æ **–º—ã –µ–≥–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º**
- –ù–∞—à–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å cookie `locale`

## –î–≤–∞ cookie - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

–í –±—Ä–∞—É–∑–µ—Ä–µ –±—É–¥–µ—Ç –¥–≤–∞ cookie:

- `locale` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—à–∏–º –∫–æ–¥–æ–º (server middleware, app.vue)
- `i18n_redirected` - —Å–æ–∑–¥–∞—ë—Ç—Å—è –º–æ–¥—É–ª–µ–º @nuxtjs/i18n, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è

–≠—Ç–æ **–Ω–µ –±–∞–≥**, —ç—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è @nuxtjs/i18n.

## –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å

‚ùå **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–ª–∞–≥–∏–Ω—ã** –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ª–æ–∫–∞–ª–∏ (—Ç–∏–ø–∞ `plugins/01.locale.client.ts`)
‚ùå **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ middleware** –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ª–æ–∫–∞–ª–∏ (—Ç–∏–ø–∞ `middleware/locale.global.ts`)
‚ùå **–ù–ï –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–µ** –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ `i18n.config.ts` –≤ `nuxt.config.ts`
‚ùå **–ù–ï –º–µ–Ω—è–π—Ç–µ** cookieKey –Ω–∞ `locale` –≤ `detectBrowserLanguage`
‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ** `useI18n()` –≤ –ø–ª–∞–≥–∏–Ω–∞—Ö - —ç—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫–∏

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª–∏

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (regional-settings.ts):

1. **–õ–æ–∫–∞–ª—å –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (–µ—Å–ª–∏ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω) - –∑–∞–ø—Ä–æ—Å –∫ –ë–î
2. Cookie `locale`
3. Query `?lang=XX`
4. –î–µ—Ñ–æ–ª—Ç `sr`

**‚úÖ –í–∞–∂–Ω–æ:** –õ–æ–∫–∞–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è SSR –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É - —ç—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏.

### –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ (app.vue):

–õ–æ–∫–∞–ª—å –ø—Ä–æ—Å—Ç–æ —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):
```typescript
const queryLocale = getLocaleFromQuery(route.query.lang);
locale.value = queryLocale || defaultLocale;
```

### –î–ª—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π!** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω, –µ–≥–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º–∞—è –ª–æ–∫–∞–ª—å –∏–∑ –ë–î (`auth_users.preferred_locale`) –∏–º–µ–µ—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç cookie –∏ query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** (`regional-settings.ts`):
```typescript
const user = await getCurrentUser(event);
if (user?.id) {
  const userLocale = await getUserLocale(user.id, event);
  if (userLocale) {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è
    // Cookie –∏ query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
    return { locale: userLocale, redirectStatus: null };
  }
}
```

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** (`language-switcher.vue`):
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é –ª–æ–∫–∞–ª—å –≤ –ë–î —á–µ—Ä–µ–∑ API
- –û–±–Ω–æ–≤–ª—è–µ—Ç cookie `locale`
- –û–±–Ω–æ–≤–ª—è–µ—Ç `i18n.locale`

## –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

```
server/
  common/redirect/
    regional-settings.ts      # ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç—ã –∏ –ª–æ–≥–∏–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  middleware/
    redirect-routes.ts        # ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç fixUrlRegionalParams
  utils/
    user-locale.ts            # ‚úÖ –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è email (server-side)

i18n/
  i18n.config.ts              # ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è @nuxtjs/i18n

app.vue                       # ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ locale –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

components/
  language-switcher.vue       # ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î)

composables/
  use-locale.ts               # ‚úÖ –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–æ–∫–∞–ª—è–º–∏
  use-user-locale.ts          # ‚úÖ API –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

## –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```typescript
// –í Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
const { locale } = useI18n();
const { updateUserLocale } = useUserLocale();

// –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î (–µ—Å–ª–∏ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω)
await updateUserLocale('ru');

// –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î)
locale.value = 'ru';
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–ª—è –Ω–µ–∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```bash
# –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç —Å —Ä—É—Å—Å–∫–æ–π –ª–æ–∫–∞–ª—å—é
http://localhost:3000/?lang=ru

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç (–¥–æ–ª–∂–µ–Ω —É–±—Ä–∞—Ç—å ?lang=sr)
http://localhost:3000/?lang=sr
# ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç 301 –Ω–∞ http://localhost:3000/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cookie
# –í DevTools ‚Üí Application ‚Üí Cookies –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
# - locale=ru (–Ω–∞—à)
# - i18n_redirected=ru (–æ—Ç @nuxtjs/i18n, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è)
```

### –î–ª—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```bash
# 1. –ó–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è
# 2. –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å —á–µ—Ä–µ–∑ language-switcher –Ω–∞ "–†—É—Å—Å–∫–∏–π"
# 3. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
# ‚Üí –î–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ (–∏–∑ –ë–î –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

# 4. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—å —Å –¥—Ä—É–≥–∏–º query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
http://localhost:3000/?lang=en
# ‚Üí Query –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ä—É—Å—Å–∫–∏–π (–∏–∑ –ë–î)
# ‚Üí –†–µ–¥–∏—Ä–µ–∫—Ç –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

# 5. –†–∞–∑–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è
# 6. –û—Ç–∫—Ä—ã—Ç—å http://localhost:3000/?lang=en
# ‚Üí –¢–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (query –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç)

# 7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSR (–ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
# ‚Üí –í HTML –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —è–∑—ã–∫
# ‚Üí –ù–µ—Ç "–≤—Å–ø—ã—à–∫–∏" –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–∫–∞–ª–∏ –ø—Ä–∏ –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏ ‚úÖ
```

## E2E —Ç–µ—Å—Ç—ã

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ end-to-end —Ç–µ—Å—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `tests/e2e/locale.spec.ts`.

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
npm run test:e2e -- locale.spec.ts

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ headed —Ä–µ–∂–∏–º–µ (—Å –±—Ä–∞—É–∑–µ—Ä–æ–º)
npm run test:e2e -- locale.spec.ts --headed

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
npm run test:e2e -- locale.spec.ts -g "should load page with Russian locale"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ debug —Ä–µ–∂–∏–º–µ
npm run test:e2e -- locale.spec.ts --debug
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

#### ‚úÖ –ù–µ–∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ª–æ–∫–∞–ª—å—é –∏–∑ query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (`?lang=ru`, `?lang=en`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ cookie
- –†–µ–¥–∏—Ä–µ–∫—Ç –æ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –ª–æ–∫–∞–ª–∏ (`?lang=sr` ‚Üí `/`)
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞–¥ cookie
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ cookie –∫–æ–≥–¥–∞ –Ω–µ—Ç query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

#### ‚úÖ –ù–µ–∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - Language Switcher:
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —è–∑—ã–∫–∞ –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

#### ‚úÖ SSR –∏ –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è:
- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–∫–∞–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏
- –û–¥–∏–Ω–∞–∫–æ–≤–∞—è –ª–æ–∫–∞–ª—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –∫–ª–∏–µ–Ω—Ç–µ

#### üîÑ –ó–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Ç—Ä–µ–±—É—é—Ç —Ñ–∏–∫—Å—Ç—É—Ä):
- –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª–∏ –∏–∑ –ë–î –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏ –≤ –ë–î –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ switcher
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ—Å–ª–µ —Ä–∞–∑–ª–æ–≥–∏–Ω–∞

#### ‚úÖ –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ª–æ–∫–∞–ª–µ–π
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ `lang` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ URL
- –£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ª–æ–∫–∞–ª–µ–π (ME, BA) –∏–∑ cookie
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏ –≤–æ –≤—Ä–µ–º—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

#### ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ layout shift –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ª–æ–∫–∞–ª–∏
- –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª–∏ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏–∑ `tests/fixtures/auth.fixture.ts`:

```typescript
import { test } from '../fixtures/auth.fixture';

test('should load user locale from database', async ({ authenticatedPage }) => {
  // authenticatedPage —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  await authenticatedPage.goto('/');
  
  const htmlLang = await authenticatedPage.getAttribute('html', 'lang');
  expect(htmlLang).toBe('ru'); // –õ–æ–∫–∞–ª—å –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
});
```

**‚ö†Ô∏è TODO:** –§–∏–∫—Å—Ç—É—Ä—ã —Ç—Ä–µ–±—É—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
1. API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`/api/test/create-user`)
2. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞ (`/login`)
3. –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Å—Å–∏—è–º–∏ –≤ —Ç–µ—Å—Ç–∞—Ö

–°–º. `tests/fixtures/auth.fixture.ts` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–§–µ–≤—Ä–∞–ª—å 2026**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–æ–≤ (`import type { Language }` ‚Üí `import { Language }`)
- **–§–µ–≤—Ä–∞–ª—å 2026**: –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `getHeader` –≤ `user-locale.ts`
- **–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è**: –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è
