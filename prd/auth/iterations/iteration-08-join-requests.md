# Итерация 8: Запросы на присоединение к клинике

[← К списку итераций](README.md) | [← Предыдущая](iteration-07-oauth-verification.md) | [Следующая →](iteration-09-admin-panel.md)

---

## Цель

Пользователи могут запрашивать доступ к редактированию клиник, администраторы могут одобрять/отклонять запросы.

## Зависимости

Итерация 6 (создание и редактирование клиник работает)

## Задачи

1. Создать API для отправки запроса на присоединение
2. Создать API для просмотра и одобрения/отклонения запросов
3. Создать UI компоненты для запросов
4. Реализовать уведомления (опционально - можно просто список в админке)

## Ключевые API Endpoints

- `POST /api/clinics/[id]/join-request` - отправить запрос
- `GET /api/clinics/[id]/join-requests` - список запросов (для админов)
- `PUT /api/clinics/[id]/join-requests/[requestId]` - одобрить/отклонить

## Ключевые компоненты

- `components/clinic/JoinRequestButton.vue` - кнопка запроса на присоединение
- `components/clinic/JoinRequestList.vue` - список запросов для админов

## Критерии приемки

- [ ] AC-1: На странице клиники показывается кнопка "Запросить доступ" для пользователей без доступа
- [ ] AC-2: При клике открывается диалог с полем для сообщения
- [ ] AC-3: После отправки запроса создается запись со status='pending'
- [ ] AC-4: Администратор клиники видит список всех запросов
- [ ] AC-5: Запросы отсортированы: pending сверху
- [ ] AC-6: Администратор может одобрить запрос - создается запись в clinic_users с role='editor'
- [ ] AC-7: Администратор может отклонить запрос - статус меняется на 'rejected'
- [ ] AC-8: После одобрения пользователь получает доступ к редактированию
- [ ] AC-9: Пользователь не может отправить повторный запрос, если уже есть pending
- [ ] AC-10: Все действия логируются в audit_logs

## Статус

**Not Started**

---

**Следующая итерация:** [9. Админ панель →](iteration-09-admin-panel.md)
