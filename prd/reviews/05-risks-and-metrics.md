# 5. Риски и метрики

[← Назад к оглавлению](index.md)

---

## 5.1 Риски и митигация

| Риск                                          | Вероятность | Влияние | Митигация                                                                                                                                                                                             |
| --------------------------------------------- | ----------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Недостаточное количество отзывов**          | Высокая     | Высокое | - Стимулировать отзывы (геймификация, бонусы)<br>- Импорт внешних отзывов<br>- Простой UX создания отзыва                                                                                             |
| **Фейковые/заказные отзывы**                  | Средняя     | Высокое | - Обязательная модерация<br>- Верификация отзывов<br>- Rate limiting<br>- Система флагов для подозрительных отзывов                                                                                   |
| **Негативные отзывы от конкурентов**          | Средняя     | Среднее | - Модерация<br>- Верификация<br>- Возможность врачей/клиник сообщить о фейке<br>- Проверка истории пользователя                                                                                       |
| **Проблемы с модерацией (перегрузка)**        | Средняя     | Среднее | - Автоматическая фильтрация (спам-слова)<br>- Приоритизация (verified сначала)<br>- Нанять дополнительных модераторов                                                                                 |
| **Стоимость OpenAI API**                      | Низкая      | Низкое  | - AI Summary генерируется только по запросу (через E2E тест)<br>- Кэширование AI Summary<br>- Генерация только при достижении порога отзывов (мин. 5)<br>- Можно выбрать более дешевую модель в тесте |
| **AI Summary низкого качества**               | Средняя     | Среднее | - Хороший промпт<br>- Валидация результата<br>- Fallback на ручное описание<br>- A/B тестирование разных промптов                                                                                     |
| **Нарушение GDPR/privacy**                    | Низкая      | Высокое | - Соблюдение законов<br>- Право на удаление<br>- Маскировка данных<br>- Модерация персональных данных                                                                                                 |
| **Низкий процент верификации**                | Высокая     | Низкое  | - Упростить процесс загрузки<br>- Стимулировать верификацию (badges, повышение в рейтинге)<br>- Принимать разные типы подтверждений                                                                   |
| **Хранение файлов верификации (место)**       | Средняя     | Низкое  | - Ограничение размера файлов (5MB)<br>- Перенос в S3/Cloudinary в будущем<br>- Очистка старых файлов                                                                                                  |
| **Проблемы с производительностью (медленно)** | Низкая      | Среднее | - Индексы БД<br>- Кэширование рейтингов<br>- Пагинация<br>- Lazy loading                                                                                                                              |

---

## 5.2 Метрики успеха

### Adoption метрики (внедрение)

| Метрика                                 | Цель        | Как измерять                                  | Частота     |
| --------------------------------------- | ----------- | --------------------------------------------- | ----------- |
| % пользователей, оставивших отзыв       | 5%          | (users with reviews / total users) × 100%     | Ежемесячно  |
| Количество отзывов на врача (среднее)   | 10+         | AVG(reviews_count) для всех врачей            | Еженедельно |
| Количество отзывов на клинику (среднее) | 15+         | AVG(reviews_count) для всех клиник            | Еженедельно |
| % врачей с отзывами                     | 70%         | (doctors with reviews / total doctors) × 100% | Ежемесячно  |
| % клиник с отзывами                     | 80%         | (clinics with reviews / total clinics) × 100% | Ежемесячно  |
| Количество внешних отзывов (всего)      | 100+ в мес. | COUNT(reviews WHERE review_type='external')   | Ежемесячно  |

### Качество метрики

| Метрика                             | Цель  | Как измерять                                                      | Частота     |
| ----------------------------------- | ----- | ----------------------------------------------------------------- | ----------- |
| % верифицированных отзывов          | 30%   | (verified reviews / total reviews) × 100%                         | Еженедельно |
| % отзывов с текстом                 | 70%   | (reviews with text / total reviews) × 100%                        | Еженедельно |
| Средняя длина отзыва (символов)     | 100+  | AVG(LENGTH(text))                                                 | Ежемесячно  |
| % отзывов с критериями оценки       | 80%   | (reviews with criteria ratings / total reviews) × 100%            | Еженедельно |
| % отклоненных отзывов при модерации | < 5%  | (rejected reviews / total reviews) × 100%                         | Еженедельно |
| Среднее время модерации (часы)      | < 24ч | AVG(moderated_at - created_at) для одобренных/отклоненных отзывов | Еженедельно |
| Средний рейтинг врачей              | 4.0+  | AVG(average_rating) для всех врачей                               | Ежемесячно  |
| Средний рейтинг клиник              | 4.2+  | AVG(average_rating) для всех клиник                               | Ежемесячно  |

### Engagement метрики (вовлеченность)

| Метрика                     | Цель       | Как измерять                                               | Частота     |
| --------------------------- | ---------- | ---------------------------------------------------------- | ----------- |
| Просмотры секции отзывов    | Мониторинг | Аналитика (GA4)                                            | Ежедневно   |
| CTR на "Написать отзыв"     | 10%        | (clicks / views) × 100%                                    | Еженедельно |
| CTR на "Читать все отзывы"  | 20%        | (clicks / views) × 100%                                    | Еженедельно |
| Использование AI Summary    | 80%        | (views AI Summary / views reviews section) × 100%          | Еженедельно |
| Использование фильтров      | 30%        | (users using filters / total users viewing reviews) × 100% | Еженедельно |
| % отредактированных отзывов | Мониторинг | (edited reviews / total reviews) × 100%                    | Ежемесячно  |
| % удаленных отзывов         | < 5%       | (deleted reviews / total reviews) × 100%                   | Ежемесячно  |

### Технические метрики

| Метрика                             | Цель       | Как измерять                            | Частота     |
| ----------------------------------- | ---------- | --------------------------------------- | ----------- |
| Время загрузки секции отзывов       | < 2 сек    | Server timing logs                      | Ежедневно   |
| Время генерации AI Summary          | < 10 сек   | API timing logs                         | Ежедневно   |
| Успешность API calls OpenAI         | > 95%      | (successful calls / total calls) × 100% | Ежедневно   |
| Стоимость OpenAI API (месяц)        | < $100     | OpenAI billing dashboard                | Ежемесячно  |
| Размер хранилища файлов верификации | Мониторинг | Disk usage monitoring                   | Еженедельно |

---

## 5.3 Мониторинг и алерты

### Критичные алерты

- **Высокий процент отклоненных отзывов** (> 10%) - возможна атака фейковыми отзывами
- **OpenAI API недоступен** - AI Summary не генерируется
- **Очередь модерации > 100 отзывов** - нужны дополнительные модераторы
- **Резкое снижение количества новых отзывов** - проблема с UX или техническая ошибка

### Важные алерты

- **Время модерации > 48 часов** - модераторы перегружены
- **Стоимость OpenAI API > $150/месяц** - превышен бюджет
- **Хранилище файлов > 20GB** - нужно очистить или мигрировать в S3
- **Средний рейтинг < 3.0** - проблема с качеством врачей/клиник

---

## 5.4 A/B тесты (для оптимизации)

### Тест 1: Мотивация создания отзывов

- **A:** Простая кнопка "Написать отзыв"
- **B:** Кнопка с иконкой и текстом "Поделитесь опытом - помогите другим"
- **C:** Кнопка + tooltip "Ваш отзыв поможет другим пациентам"

**Метрика:** CTR на кнопку

### Тест 2: Отображение AI Summary

- **A:** AI Summary всегда развернут (над отзывами)
- **B:** AI Summary свернут, нужно кликнуть "Показать AI анализ"
- **C:** AI Summary в отдельной вкладке

**Метрика:** % пользователей, просмотревших AI Summary

### Тест 3: Форма создания отзыва

- **A:** Одношаговая форма (все поля сразу)
- **B:** Двухшаговая (шаг 1: оценка, шаг 2: текст и критерии)
- **C:** Трехшаговая (шаг 1: оценка, шаг 2: текст, шаг 3: верификация)

**Метрика:** % завершенных отзывов (completion rate)

### Тест 4: Верификация

- **A:** Верификация опциональна, предлагается после создания отзыва
- **B:** Верификация опциональна, предлагается в форме создания
- **C:** Верификация обязательна (отзыв не публикуется без нее)

**Метрика:** % верифицированных отзывов

---

## 5.5 KPI Dashboard (для stakeholders)

### Топ KPI (еженедельный отчет)

1. **Количество новых отзывов** (за неделю)
2. **% пользователей с отзывами** (за все время)
3. **Средний рейтинг врачей** (текущий)
4. **Средний рейтинг клиник** (текущий)
5. **% верифицированных отзывов** (за все время)
6. **Очередь модерации** (текущая)
7. **Стоимость OpenAI API** (за месяц)

### График тренда

- Количество отзывов по неделям (линейный график)
- Распределение отзывов по оценкам (histogram)
- % верификации по неделям (линейный график)

---

## 5.6 Вопросы для уточнения

- [ ] Какие конкретно платформы для импорта внешних отзывов приоритетны? (Facebook, Google Maps, ...)
- [ ] Какой бюджет на OpenAI API? (влияет на частоту регенерации AI Summary)
- [ ] Нужна ли геймификация для стимулирования отзывов? (badges, рейтинги пользователей)
- [ ] Нужны ли уведомления пользователям о статусе модерации? (email, push)
- [ ] Нужна ли возможность врачам/клиникам отвечать на отзывы? (scope следующей версии)
- [ ] Какие критерии для автоматического отклонения отзывов? (спам-слова, короткие отзывы)

---

**Предыдущий раздел:** [← 4. База данных](04-database.md)  
**Следующий раздел:** [Итерации разработки →](iterations/README.md)
